[*] Windows Versions
Operating System Names				Version Number
Windows NT 4					4.0
Windows 2000					5.0
Windows XP					5.1
Windows Server 2003, 2003 R2			5.2
Windows Vista, Server 2008			6.0
Windows 7, Server 2008 R2			6.1
Windows 8, Server 2012				6.2
Windows 8.1, Server 2012 R2			6.3
Windows 10, Server 2016, Server 2019		10.0

[*] Information Gather - PowerShell
	Get-WmiObject
	Get-WmiObject -Class win32_OperatingSystem | select Version,BuildNumber
	Get-WmiObject -Class Win32_Process
	Get-WmiObject -Class Win32_Service
	Get-WmiObject -Class Win32_Bios
	# More can be done with this Cmd, like remote start/stop of machines.
	# https://adamtheautomator.com/get-wmiobject/
	# https://ss64.com/ps/get-wmiobject.html

[*] Linux command for RDP:
	xfreerdp /v:<targetIp> /u:htb-student /p:Password

[*] Integrity Control Access Control List (icacls)
	NTFS permissions on files and directories. Examples:
		icacls C:\Windows
	You will see shortened permissions like (CI).
	Use this list to check what perms this directory/file has:

(CI): container inherit
(OI): object inherit
(IO): inherit only
(NP): do not propagate inherit
(I): permission inherited from parent container
F : full access
D :  delete access
N :  no access
M :  modify access
RX :  read and execute access
R :  read-only access
W :  write-only access

	Example of granting and revoking permissions for a user:
		icacls C:\Users /grant user:f # Only grants access to current directory \Users
		icacls C:\Users /remove user
	More can be learned here:
	https://ss64.com/nt/icacls.html


[*] Windows Services
	Windows Services are controlled in the Service Control Manager (SCM), accessible via services.msc MMC addin.
	cmd tool is sc.exe
		sc query Appinfo
	Powershell cmdlet is Get-Service
		Get-Service
		Get-Service | ? {$_.Status -eq "Running"}
		Get-Service | ? {$_.Status -eq "Running"} | select -First 2 | fl
		cmd.exe /c sc query Appinfo

	Services below that are modified must go through a reboot to take effect:
Service				Description
smss.exe			Session Manager SubSystem. Responsible for handling sessions on the system.
csrss.exe			Client Server Runtime Process. The user-mode portion of the Windows subsystem.
wininit.exe			Starts the Wininit file .ini file that lists all of the changes to be made to Windows when the computer
				is restarted after installing a program.
logonui.exe			Used for facilitating user login into a PC
lsass.exe			The Local Security Authentication Server verifies the validity of user logons to a PC or server. It 
				generates the process responsible for authenticating users for the Winlogon service.
services.exe			Manages the operation of starting and stopping services.
winlogon.exe			Responsible for handling the secure attention sequence, loading a user profile on logon, and locking
				the computer when a screensaver is running.
System				A background system process that runs the Windows kernel.
svchost.exe with RPCSS		Manages system services that run from dynamic-link libraries (files with the extension .dll) such as
				"Automatic Updates," "Windows Firewall," and "Plug and Play." Uses the Remote Procedure Call (RPC) 
				Service (RPCSS).
svchost.exe with Dcom/PnP	Manages system services that run from dynamic-link libraries (files with the extension .dll) such as
				"Automatic Updates," "Windows Firewall," and "Plug and Play." Uses the Distributed Component Object Model
				(DCOM) and Plug and Play (PnP) services.

	More key services:
		https://en.wikipedia.org/wiki/List_of_Microsoft_Windows_components#Services



[*] Task Manager CLI
	tasklist
	tasklist /v
	tasklist /v | findstr "mimika"
	taskkill /im:mimikatz.exe
	taskkill /f /im:mimikatz.exe

[*] Windows Components and Services
	https://en.wikipedia.org/wiki/List_of_Microsoft_Windows_components#Services

[*] Tools you may run without installing on disk:
	https://live.sysinternals.com/
	\\live.sysinternals.com\tools\procdump.exe /accepteula
