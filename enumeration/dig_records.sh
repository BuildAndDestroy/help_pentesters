#!/bin/bash
############################
#      Reconnaisance       #
# Dig a Domain for records #
############################


DOMAIN=$1
DNSSERVER=$2

function domain_check() {
    if [[ `echo $DOMAIN` == '' ]]; then
        echo '[*] Please provide a domain. Example:' 
        echo '    ./dig_records.sh google.com'
        echo '        OR'
        echo '    ./dig_records.sh google.com @192.168.1.1'
        exit
    fi
}

function dns_directory_check() {
    if [[ `ls | grep DNS` != 'DNS' ]]; then
        mkdir DNS
    fi
}

function dig_domain() {
    for i in A AAAA ANY CAA CNAME DNSKEY DS MX NS PTR SOA SRV TLSA TSIG TXT; do
        if [[ `echo $DNSSERVER` == '' ]]; then
            dig $i $DOMAIN > DNS/$i.out
        fi
        if [[ `echo $DNSSERVER` != '' ]]; then
            dig $i $DOMAIN @$DNSSERVER > DNS/$i.out
        fi
    done
}

#############################
# Functions to exec on main #
#############################

domain_check
dns_directory_check
dig_domain
